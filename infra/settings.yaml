shared:
  identity:
    resourceGroup: apim-plat-identity-rg
    usersAssigned:
      - name: apim-plat-script-identity
        scope:
          type: subscription
          name: ''
        rbacRoleAssignment:
          roles:
            - roleName: "Storage Account Contributor"
              id: "17d1049b-9a84-46fb-8f53-869881c3d3ab" # Storage Account Contributor Role ID
      - name: apim-keyvault-identity
        scope:
          type: resourceGroup
          name: apim-plat-security-rg
        rbacRoleAssignment:
          roles:
            - roleName: "Key Vault Secrets User"
              id: "4633458b-17de-408a-b874-0445c86b69e6" # Key Vault Secrets User Role ID
            - roleName: "Key Vault Secrets Officer"
              id: "b86a8fe4-44ce-4948-aee5-eccb2c155cd7" # Key Vault Secrets Officer Role ID

  connectivity:
    resourceGroup: apim-plat-connectivity-rg
    publicNetworkAccess: true
    virtualNetwork:
      name: apim-plat-vnet
      addressPrefixes:
        - 10.0.0.0/16
      subnets:
        - name: apim-plat-subnet
          addressPrefix: 10.0.1.0/24
          networkSecurityGroup:
            name: apim-plat-nsg
            rules: []
        - name: apim-plat-app-gateway-subnet
          addressPrefix: 10.0.2.0/24
          networkSecurityGroup:
            name: apim-plat-app-gateway-nsg
            rules: []

  monitoring:
    resourceGroup: apim-plat-monitoring-rg
    logAnalytics:
      name: apim-plat-log-analytics
    applicationInsights:
      name: apim-plat-app-insights

  security:
    resourceGroup: apim-plat-security-rg
    keyVault:
      name: apim-plat-kv

core:
  apiManagement:
    resourceGroup: apim-plat-apim-rg
    name: apim-plat
    identity:
      type: 'SystemAssigned, UserAssigned'
      systemAssigned:
        scope:
          type: resourceGroup
          name: apim-plat-security-rg
        rbacRoleAssignment:
          roles:
            - roleName: "Key Vault Secrets User"
              id: "4633458b-17de-408a-b874-0445c86b69e6" # Key Vault Secrets User Role ID
            - roleName: "Key Vault Secrets Officer"
              id: "b86a8fe4-44ce-4948-aee5-eccb2c155cd7" # Key Vault Secrets Officer Role ID

      usersAssigned:
        resourceGroup: apim-plat-identity-rg
        identities:
          - name: apim-keyvault-identity
          - name: apim-plat-script-identity
    
    virtualNetwork:
      subnetName: apim-plat-subnet
      virtualNetworkName: apim-plat-vnet
    
    sku:
      name: Premium
      capacity: 3
      zones:
        - 1
        - 2
        - 3
    publisherEmail: publisher@example.com
    publisherName: Contoso API Team

tags:
  CostCenter: "CC-1234" # Tracks cost allocation
  BusinessUnit: "IT" # Business unit or department
  Owner: "jdoe@contoso.com" # Resource/application owner
  ApplicationName: "APIM Platform" # Workload/application name

  Environment: "Production" # Environment (Dev, Test, QA, Prod)
  Lifecycle: "Operational" # Lifecycle stage
  ProjectName: "APIMForAll" # Project or initiative name
  ServiceClass: "Critical" # Workload tier (Critical, Standard, Experimental)

  DataClassification: "Confidential" # Data sensitivity (Public, Internal, Confidential, HighlyConfidential)
  RegulatoryCompliance: "GDPR" # Compliance requirements (GDPR, HIPAA, PCI, None)

  SupportContact: "cloudops@contoso.com" # Incident support team or contact

  ChargebackModel: "Dedicated" # Chargeback/Showback model
  BudgetCode: "FY25-Q1-InitiativeX" # Budget or initiative code
  ServiceOwner: "asmith@contoso.com" # Service manager accountable
